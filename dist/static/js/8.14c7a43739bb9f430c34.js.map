{"version":3,"sources":["webpack:///src/views/compBindCa/Index.vue","webpack:///./src/views/compBindCa/Index.vue?eb1e","webpack:///./src/views/compBindCa/Index.vue"],"names":["Index","components","inputItem","complexInputItem","data","showTD","clientHeight","caL_errMsg","dsb","fruit","entryt","fsecond","ftimer","fsd","errMsg","cabind_error","bindCaUpdata","formValidate","userOldPassword","userNewPassword","confirmPwd","name","applyOrg","bindingOrg","serialNum","express","interest","ruleValidate","required","message","trigger","computed","extends_default","Object","vuex_esm","mounted","this","getOrgStatu","created","methods","_this","getOrgStatus","then","res","$store","state","org_status","account","org_name","relogin","clearInterval","loginOut","$router","push","fiveCountd","to","setInterval","window","location","href","bind","openBindCa","modal3","$refs","resetFields","document","getElementById","setAttribute","style","display","insCustom","objks","object","repSerial","updata","_this2","console","log","stringify_default","getSerials","success","content","retRes","generalName","username","getSerial","_this3","browVs","sessionStorage","getItem","getRandom","serRandom","serR","me","restatus","socket","getcert","getCertBsfNoIE","onmessage","msg","dealWithResponseMessage","onclose","onerror","getCertBsf","bindCas","_this4","validate","valid","length","check","type","bindCa","$route","query","noPerfM","removeAttribute","errmsg","compBindCa_Index","render","_vm","_h","$createElement","_c","_self","staticClass","ref","attrs","model","rules","label-width","id","label","prop","value","callback","$$v","$set","expression","_v","on","click","staticStyle","visibility","_s","width","margin-left","$event","border-top","padding","_m","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/8.14c7a43739bb9f430c34.js","sourcesContent":["<style lang=\"scss\" scoped>\r\n  .publicInput /deep/ .ivu-form-item-error-tip {\r\n    left: 112px;\r\n  }\r\n  .cont /deep/ .ivu-input-wrapper {\r\n    width: 448px;\r\n  }\r\n  .dispnone{display: none}\r\n  .butWid{width: 250px}\r\n  .setsuctitle{margin: 0 auto;text-align: center;font-size: 24px}\r\n  .setsuctip{margin: 0 auto;text-align: center;font-size: 14px}\r\n  .mcenter{margin: 0 auto}\r\n  .talignc{text-align: center}\r\n  .textred{color: red;margin: 0 10px}\r\n  .relot{\r\n    color: #2d8cf0;\r\n    cursor: pointer;\r\n  }\r\n  .errRemind{\r\n    text-align: left;\r\n    margin-bottom: 10px;\r\n    font-size: 16px;\r\n    color: red;\r\n  }\r\n  .xlh{\r\n    width: 150px;background-color: #2d8cf0;color: #fff;text-align: center;position: relative;margin: -35px 0 0 300px;border-radius: 3px;cursor: pointer\r\n  }\r\n.cont{width: 550px;margin: 0 auto}\r\n.hmid{ position: absolute;top: 50%;left: 50%; transform: translateY(-50%) translateX(-50%);}\r\n/*.hmid input{*/\r\n    /*pointer-events: none;*/\r\n  /*}*/\r\n</style>\r\n\r\n<template>\r\n  <div class=\"container--fluid cbco\">\r\n    <Form ref=\"formValidates\" :model=\"formValidate\" :rules=\"ruleValidate\" :label-width=\"90\" id=\"caBindf\" class=\"hmid cont\">\r\n      <FormItem label=\"账号\" prop=\"name\" class=\"unedit mb14\">\r\n        <Input v-model=\"formValidate.name\"></Input>\r\n      </FormItem>\r\n      <FormItem label=\"报名企业\" prop=\"applyOrg\" class=\"unedit mb14\">\r\n        <Input v-model=\"formValidate.applyOrg\"></Input>\r\n      </FormItem>\r\n      <FormItem label=\"绑定企业\" prop=\"bindingOrg\" class=\"unedit mb14\">\r\n        <Input v-model=\"formValidate.bindingOrg\"></Input>\r\n      </FormItem>\r\n      <FormItem label=\"证书序列号\" prop=\"serialNum\" class=\"unedit mb14\">\r\n        <Input v-model=\"formValidate.serialNum\"></Input>\r\n        <div class=\"xlh\" @click=\"getSerial\">获取序列号</div>\r\n      </FormItem>\r\n\r\n      <FormItem label=\"通用名校验\" prop=\"interest\" class=\"mb14\">\r\n        <CheckboxGroup v-model=\"formValidate.interest\" >\r\n          <Checkbox label=\"（校验企业/机构名称与绑定企业是否一致）\"></Checkbox>\r\n        </CheckboxGroup>\r\n      </FormItem>\r\n      <FormItem label=\"有效期\" prop=\"express\" class=\"unedit mb14\">\r\n        <Input v-model=\"formValidate.express\"></Input>\r\n      </FormItem>\r\n      <FormItem class=\"mb14\">\r\n        <div style=\"visibility: visible\"><p class='errRemind'>{{cabind_error}}</p></div>\r\n        <Button type=\"primary\" @click=\"bindCas('formValidates')\" style=\"width: 150px;margin-left: 60px\">保存</Button>\r\n      </FormItem>\r\n      <div style=\"border-top: 1px solid #e9eaec;\" >\r\n        <div style=\"padding: 12px 18px 12px 18px;\">{{caL_errMsg}}</div>\r\n      </div>\r\n    </Form>\r\n\r\n    <div  id=\"caBindNext\"  class=\"dispnone\">\r\n      <div  class=\"setsuctitle\"><span>恭喜您！CA绑定成功，请重新登录！</span></div>\r\n      <div  class=\"setsuctip\"><span>系统将在</span><span class=\"textred\">{{fsecond}}</span>秒后自动自动回到登录页面，您可以选择<span class=\"relot\" @click='relogin'>重新登录</span></div>\r\n    </div>\r\n\r\n    <div id=\"caBindNexts\" class=\"dispnone\">\r\n      <div  class=\"setsuctitle\"><span>恭喜您！CA绑定成功，请继续完善资料！</span></div>\r\n      <div  class=\"setsuctip\"><span>系统将在</span><span class=\"textred\">{{fsecond}}</span>秒后自动自动回关闭绑定页面</div>\r\n    </div>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n/**\r\n * 显示用户名和设置的通用头部\r\n */\r\nimport { mapState, mapActions } from 'vuex'\r\nimport inputItem from '../../components/complexInputItem'\r\nimport getcert from '../../assets/js/getcert'\r\nexport default {\r\n  components: {\r\n    inputItem\r\n  },\r\n  data() {\r\n    return {\r\n      showTD: true,\r\n      clientHeight: '500',\r\n      caL_errMsg: '首次登录时，请下载并安装\"CA证书客户端\"，仅支持IE浏览器。',\r\n      dsb : true,\r\n      fruit:['（自动校验报名企业与绑定企业是否一致）'],\r\n      entryt: 1,\r\n      fsecond: 5,\r\n      ftimer: null,\r\n      fsd: true,\r\n      errMsg: '',\r\n      cabind_error: '',\r\n      bindCaUpdata: '',\r\n      // 表单\r\n      formValidate: {\r\n        userOldPassword: '',\r\n        userNewPassword: '',\r\n        confirmPwd: '',\r\n        name: '',\r\n        applyOrg: '',\r\n        bindingOrg: '',\r\n        serialNum: '',\r\n        express: '',\r\n        interest: ['（校验企业/机构名称与绑定企业是否一致）']\r\n\r\n      },\r\n      ruleValidate: {\r\n        name: [\r\n          { required: true, message: '账号不能为空', trigger: 'blur' }\r\n        ],\r\n        applyOrg: [\r\n          { required: true, message: '报名企业不能为空', trigger: 'blur' }\r\n        ],\r\n        bindingOrg: [\r\n          { required: true, message: '绑定企业不能为空', trigger: 'blur' }\r\n        ],\r\n        serialNum: [\r\n          { required: true, message: '证书序列号不能为空', trigger: 'blur' }\r\n        ],\r\n        express: [\r\n          { required: true, message: '有效期不能为空', trigger: 'blur' }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState(['app','entry','org_status'])\r\n\r\n  },\r\n  mounted() {\r\n    this.getOrgStatu()\r\n  },\r\n  created() {\r\n    //this.getOrgStatu()\r\n  },\r\n  methods: {\r\n    ...mapActions(['loginOut','getSerials','getRandom','bindCa','getOrgStatus']),\r\n    getOrgStatu: function(){\r\n      this.getOrgStatus().then(res => {\r\n        this.formValidate.name = this.$store.state.org_status.account\r\n        this.formValidate.applyOrg = this.$store.state.org_status.org_name\r\n        //console.log(\"orgstatus: \"+JSON.stringify(res))\r\n      })\r\n    },\r\n    //重新登陆\r\n    relogin: function(){\r\n      clearInterval(this.ftimer)\r\n      this.loginOut()\r\n      this.$router.push('/login?tag=ca')\r\n    },\r\n    //倒计时\r\n    fiveCountd: function(to){\r\n      this.fsecond = 5\r\n      clearInterval(this.ftimer)\r\n      this.ftimer = null\r\n      if(this.fsd){\r\n        this.ftimer = setInterval(function(){\r\n          this.fsecond--\r\n          if(this.fsecond==0){\r\n            clearInterval(this.ftimer);\r\n            if(to==2){\r\n              this.loginOut()\r\n              this.$router.push('/login?tag=ca')\r\n            }else if (to==1){\r\n              window.location.href = '/dws/ocs/main/menu'\r\n            }\r\n          }\r\n        }.bind(this),1000)\r\n      }\r\n\r\n    },\r\n    openBindCa() {\r\n      this.cabind_error = ''\r\n      this.modal3 = true\r\n      this.$refs['formValidates'].resetFields()\r\n      //alert(JSON.stringify(this.$store.state.org_status))\r\n      this.formValidate.name = this.$store.state.org_status.account\r\n      this.formValidate.applyOrg = this.$store.state.org_status.org_name\r\n      document.getElementById(\"caBindNext\").setAttribute(\"class\",\"dispnone\");\r\n      document.getElementById(\"caBindf\").style.display = \"block\"\r\n      document.getElementById(\"calerrordiv\").style.display = \"block\"\r\n    },\r\n    insCustom() {\r\n      var objks = document.getElementById(\"obj\");\r\n      if (objks == null || objks.object == null){\r\n        this.cabind_error = \"您未使用新版证书或未正确安装证书驱动\";\r\n        return false;\r\n      } else {\r\n        this.cabind_error = \"\";\r\n      }\r\n    },\r\n    repSerial(updata) {\r\n      console.log(\"1\"+JSON.stringify(updata))\r\n      if(updata){\r\n        this.getSerials(updata).then(/*获取序列号*/\r\n          res => {\r\n            if (res.success) {\r\n              console.log(\"2\"+JSON.stringify(res.content))\r\n              let retRes = res.content\r\n              this.formValidate.bindingOrg = retRes.generalName\r\n              this.formValidate.serialNum = retRes.serialNum\r\n              this.formValidate.express = retRes.express\r\n              updata.applyOrg = this.formValidate.applyOrg\r\n              updata.bindingOrg = this.formValidate.bindingOrg\r\n              updata.serialNum = this.formValidate.serialNum\r\n              updata.express = this.formValidate.express\r\n              updata.username = this.formValidate.name\r\n\r\n              this.bindCaUpdata = updata\r\n            }\r\n          }\r\n        )\r\n\r\n      }\r\n    },\r\n    getSerial() {\r\n      var browVs = sessionStorage.getItem(\"browV\")\r\n      /*IE浏览器*/\r\n      if(browVs != 'edge' && browVs != -1 ){\r\n        this.insCustom()\r\n      }\r\n      this.getRandom().then(res => {/*获取随机数*/\r\n        console.log(res)\r\n        this.serRandom = res.content\r\n        let updata = 0, serR = res.content, me = this, restatus = 0;\r\n\r\n        /*非IE浏览器*/\r\n        if(browVs == 'edge' || browVs == -1 ){\r\n          //updata = getcert.getCertBsfNoIE(this.serRandom)\r\n          // 执行接收消息事件\r\n          let socket = getcert.getCertBsfNoIE(this.serRandom)\r\n          socket.onmessage = function (msg)\r\n          {\r\n            if (typeof msg.data == \"string\")\r\n            {\r\n              updata =  getcert.dealWithResponseMessage(msg.data, serR)/*获取证书，签串*/\r\n              if(updata == 1){\r\n                me.cabind_error = \"未检测到UKey或Ukey未登陆\"\r\n                return\r\n              }\r\n              me.repSerial(updata)\r\n            }\r\n          }\r\n          socket.onclose = function (msg)\r\n          {\r\n            console.log(\"socket closed!\")\r\n            if (restatus != 1){\r\n              restatus = 2\r\n              me.cabind_error = \"请重新连接\";\r\n            }\r\n          };\r\n          socket.onerror  = function (msg)\r\n          {\r\n            console.log(\"socket error!\")\r\n            restatus = 1\r\n            me.cabind_error = \"您未使用新版证书或未正确安装证书驱动\";\r\n          }\r\n        }else{/*IE浏览器*/\r\n          updata = getcert.getCertBsf(this.serRandom) /*获取证书，签串*/\r\n          if(updata == 1){\r\n            this.cabind_error = \"未检测到UKey或Ukey未登陆\"\r\n            return\r\n          }\r\n          this.repSerial(updata)\r\n\r\n        }\r\n\r\n      })\r\n    },\r\n    bindCas(){\r\n      this.$refs['formValidates'].validate(valid => {\r\n        // 判断是否通过本地验证\r\n        if (!valid) return\r\n        if(this.formValidate.interest.length>0){\r\n          this.bindCaUpdata.check = 1\r\n        }else{\r\n          this.bindCaUpdata.check = 2\r\n        }\r\n        this.bindCaUpdata.type = 'login'\r\n        //alert(JSON.stringify(this.bindCaUpdata))\r\n        this.bindCa(this.bindCaUpdata).then(\r\n          res => {\r\n            console.log(\"bind success: \"+JSON.stringify(res))\r\n            if(res.success){\r\n              let nfMa = this.$route.query.noPerfM\r\n              if(nfMa == '1'){/*未完善资料未绑定CA*/\r\n                document.getElementById(\"caBindNexts\").removeAttribute(\"class\",\"dispnone\");\r\n                document.getElementById(\"caBindNexts\").setAttribute(\"class\",\"hmid cont\");\r\n                this.fiveCountd(1)\r\n              }else{/*已完善资料未绑定CA*/\r\n                document.getElementById(\"caBindNext\").removeAttribute(\"class\",\"dispnone\");\r\n                document.getElementById(\"caBindNext\").setAttribute(\"class\",\"hmid cont\");\r\n                this.fiveCountd(2)\r\n              }\r\n              document.getElementById(\"caBindf\").style.display = \"none\"\r\n              document.getElementById(\"calerrordiv\").style.display = \"none\"\r\n            }\r\n          },\r\n          res => {\r\n            console.log(\"bind fail: \"+JSON.stringify(res))\r\n            this.cabind_error = res.errmsg\r\n          }\r\n        )\r\n      })\r\n\r\n\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style src='./comBindCa.css' lang='scss'></style>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/compBindCa/Index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container--fluid cbco\"},[_c('Form',{ref:\"formValidates\",staticClass:\"hmid cont\",attrs:{\"model\":_vm.formValidate,\"rules\":_vm.ruleValidate,\"label-width\":90,\"id\":\"caBindf\"}},[_c('FormItem',{staticClass:\"unedit mb14\",attrs:{\"label\":\"账号\",\"prop\":\"name\"}},[_c('Input',{model:{value:(_vm.formValidate.name),callback:function ($$v) {_vm.$set(_vm.formValidate, \"name\", $$v)},expression:\"formValidate.name\"}})],1),_vm._v(\" \"),_c('FormItem',{staticClass:\"unedit mb14\",attrs:{\"label\":\"报名企业\",\"prop\":\"applyOrg\"}},[_c('Input',{model:{value:(_vm.formValidate.applyOrg),callback:function ($$v) {_vm.$set(_vm.formValidate, \"applyOrg\", $$v)},expression:\"formValidate.applyOrg\"}})],1),_vm._v(\" \"),_c('FormItem',{staticClass:\"unedit mb14\",attrs:{\"label\":\"绑定企业\",\"prop\":\"bindingOrg\"}},[_c('Input',{model:{value:(_vm.formValidate.bindingOrg),callback:function ($$v) {_vm.$set(_vm.formValidate, \"bindingOrg\", $$v)},expression:\"formValidate.bindingOrg\"}})],1),_vm._v(\" \"),_c('FormItem',{staticClass:\"unedit mb14\",attrs:{\"label\":\"证书序列号\",\"prop\":\"serialNum\"}},[_c('Input',{model:{value:(_vm.formValidate.serialNum),callback:function ($$v) {_vm.$set(_vm.formValidate, \"serialNum\", $$v)},expression:\"formValidate.serialNum\"}}),_vm._v(\" \"),_c('div',{staticClass:\"xlh\",on:{\"click\":_vm.getSerial}},[_vm._v(\"获取序列号\")])],1),_vm._v(\" \"),_c('FormItem',{staticClass:\"mb14\",attrs:{\"label\":\"通用名校验\",\"prop\":\"interest\"}},[_c('CheckboxGroup',{model:{value:(_vm.formValidate.interest),callback:function ($$v) {_vm.$set(_vm.formValidate, \"interest\", $$v)},expression:\"formValidate.interest\"}},[_c('Checkbox',{attrs:{\"label\":\"（校验企业/机构名称与绑定企业是否一致）\"}})],1)],1),_vm._v(\" \"),_c('FormItem',{staticClass:\"unedit mb14\",attrs:{\"label\":\"有效期\",\"prop\":\"express\"}},[_c('Input',{model:{value:(_vm.formValidate.express),callback:function ($$v) {_vm.$set(_vm.formValidate, \"express\", $$v)},expression:\"formValidate.express\"}})],1),_vm._v(\" \"),_c('FormItem',{staticClass:\"mb14\"},[_c('div',{staticStyle:{\"visibility\":\"visible\"}},[_c('p',{staticClass:\"errRemind\"},[_vm._v(_vm._s(_vm.cabind_error))])]),_vm._v(\" \"),_c('Button',{staticStyle:{\"width\":\"150px\",\"margin-left\":\"60px\"},attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.bindCas('formValidates')}}},[_vm._v(\"保存\")])],1),_vm._v(\" \"),_c('div',{staticStyle:{\"border-top\":\"1px solid #e9eaec\"}},[_c('div',{staticStyle:{\"padding\":\"12px 18px 12px 18px\"}},[_vm._v(_vm._s(_vm.caL_errMsg))])])],1),_vm._v(\" \"),_c('div',{staticClass:\"dispnone\",attrs:{\"id\":\"caBindNext\"}},[_vm._m(0),_vm._v(\" \"),_c('div',{staticClass:\"setsuctip\"},[_c('span',[_vm._v(\"系统将在\")]),_c('span',{staticClass:\"textred\"},[_vm._v(_vm._s(_vm.fsecond))]),_vm._v(\"秒后自动自动回到登录页面，您可以选择\"),_c('span',{staticClass:\"relot\",on:{\"click\":_vm.relogin}},[_vm._v(\"重新登录\")])])]),_vm._v(\" \"),_c('div',{staticClass:\"dispnone\",attrs:{\"id\":\"caBindNexts\"}},[_vm._m(1),_vm._v(\" \"),_c('div',{staticClass:\"setsuctip\"},[_c('span',[_vm._v(\"系统将在\")]),_c('span',{staticClass:\"textred\"},[_vm._v(_vm._s(_vm.fsecond))]),_vm._v(\"秒后自动自动回关闭绑定页面\")])])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"setsuctitle\"},[_c('span',[_vm._v(\"恭喜您！CA绑定成功，请重新登录！\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"setsuctitle\"},[_c('span',[_vm._v(\"恭喜您！CA绑定成功，请继续完善资料！\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-2fc891ac\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.2@vue-loader/lib/selector.js?type=template&index=0!./src/views/compBindCa/Index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2fc891ac\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=styles&index=0!./Index.vue\")\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2fc891ac\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!./comBindCa.css\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./Index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./Index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2fc891ac\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=template&index=0!./Index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-2fc891ac\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/compBindCa/Index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}