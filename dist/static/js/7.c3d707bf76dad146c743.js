webpackJsonp([7],{G8pV:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("3cXf"),a=i.n(s),r=i("4YfN"),n=i.n(r),o=i("9rMa"),l=i("H5im"),c=i("MWK4"),d=(i("fAxu"),{components:{inputItem:l.a},data:function(){return{showForm:!0,showTipMsg:!0,showTD:!1,showT:!0,lookBindCa:"",picCode:"请输入图文验证码",phoneVcode:"请输入短信验证码",ind:"1",disabledBtn:!1,time:120,timer:null,showxlh:!0,showSave:!0,caL_errMsg:'首次登录时，请下载并安装"CA证书客户端"，仅支持IE浏览器。',dsb:!0,fruit:["（自动校验报名企业与绑定企业是否一致）"],entryt:1,modal3:!0,fsecond:5,ftimer:null,fsd:!0,errMsg:"",cabind_error:"",baseMaterError:"",reBindPerrMsg:"",bindCaUpdata:"",formValidate:{userOldPassword:"",userNewPassword:"",confirmPwd:"",name:"",applyOrg:"",bindingOrg:"",serialNum:"",express:"",interest:["（校验企业/机构名称与绑定企业是否一致）"],account:"",realname:"",mobile:"",personid:"",remark:"",phone:"",phoneCode:"",NewPhone:"",vcode:"",nPhoneCode:""},ruleValidate:{}}},computed:n()({},Object(o.c)(["app","entry","org_status"]),{path:function(){return this.$route.fullPath}}),created:function(){this.rules(),this.getUserInfo()},methods:n()({},Object(o.b)(["loginOut","getSerials","getRandom","bindCa","validBindCa"]),{getUserInfo:function(){this.cabind_error="",this.formValidate.name=this.$store.state.org_status.account,this.formValidate.applyOrg=this.$store.state.org_status.org_name,this.showForm=!0,this.showTipMsg=!0,this.showTD=!1},relogin:function(){this.loginOut(),this.$router.push("/login")},fiveCountd:function(e){this.fsecond=5,clearInterval(this.ftimer),this.ftimer=null,this.fsd&&(this.ftimer=setInterval(function(){this.fsecond--,0==this.fsecond&&(clearInterval(this.ftimer),window.location.href="/dws/ocs/main/menu",this.modal3=!1)}.bind(this),1e3))},insCustom:function(){var e=document.getElementById("obj");if(null==e||null==e.object)return this.cabind_error="您尚未安装证书客户端，请通过登录页面底部的链接下载最新版本证书客户端并安装。",!1;this.cabind_error=""},repSerial:function(e){var t=this;console.log("1"+a()(e)),e&&this.getSerials(e).then(function(i){if(i.success){console.log("2"+a()(i.content));var s=i.content;t.formValidate.bindingOrg=s.generalName,t.formValidate.serialNum=s.serialNum,t.formValidate.express=s.express,e.applyOrg=t.formValidate.applyOrg,e.bindingOrg=t.formValidate.bindingOrg,e.serialNum=t.formValidate.serialNum,e.express=t.formValidate.express,e.username=t.formValidate.name,t.bindCaUpdata=e}})},getSerial:function(){var e=this,t=sessionStorage.getItem("browV");"edge"!=t&&-1!=t&&this.insCustom(),this.getRandom().then(function(i){console.log(i),e.serRandom=i.content;var s=0,a=i.content,r=e,n=0;if("edge"==t||-1==t){var o=c.a.getCertBsfNoIE(e.serRandom);o.onmessage=function(e){if("string"==typeof e.data){if(1==(s=c.a.dealWithResponseMessage(e.data,a)))return void(r.cabind_error="未检测到UKey或Ukey未登陆");r.repSerial(s)}},o.onclose=function(e){console.log("socket closed!"),1!=n&&(n=2,r.cabind_error="请重新连接")},o.onerror=function(e){console.log("socket error!"),n=1,r.cabind_error="您未使用新版证书或未正确安装证书驱动"}}else{if(1==(s=c.a.getCertBsf(e.serRandom)))return void(e.cabind_error="未检测到UKey或Ukey未登陆");e.repSerial(s)}})},bindCas:function(){var e=this;this.$refs.formValidates.validate(function(t){t&&(e.formValidate.interest.length>0?e.bindCaUpdata.check=1:e.bindCaUpdata.check=2,e.bindCaUpdata.type="portal",e.bindCa(e.bindCaUpdata).then(function(t){t.success&&(e.showForm=!1,e.showTipMsg=!1,e.showTD=!0,e.fiveCountd(1))},function(t){e.cabind_error=t.errmsg}))})},rules:function(){this.ruleValidate={name:[{required:!0,message:"账号不能为空",trigger:"blur"}],applyOrg:[{required:!0,message:"报名企业不能为空",trigger:"blur"}],bindingOrg:[{required:!0,message:"绑定企业不能为空",trigger:"blur"}],serialNum:[{required:!0,message:"证书序列号不能为空",trigger:"blur"}],express:[{required:!0,message:"有效期不能为空",trigger:"blur"}]}}})}),u={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Modal",{staticClass:"modal3",attrs:{width:"600"},model:{value:e.modal3,callback:function(t){e.modal3=t},expression:"modal3"}},[i("p",{staticStyle:{color:"#1c2438","text-align":"left"},attrs:{slot:"header"},slot:"header"},[i("Icon",{attrs:{type:"ios-information-circle"}}),e._v(" "),i("span",[e._v("CA绑定")])],1),e._v(" "),e.showForm?i("Form",{ref:"formValidates",class:e.lookBindCa?"form---disabled":"",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":90,id:"caBindf"}},[i("FormItem",{attrs:{label:"账号",prop:"name"}},[i("Input",{staticClass:"noEdit",model:{value:e.formValidate.name,callback:function(t){e.$set(e.formValidate,"name",t)},expression:"formValidate.name"}})],1),e._v(" "),i("FormItem",{attrs:{label:"报名企业",prop:"applyOrg"}},[i("Input",{staticClass:"noEdit",model:{value:e.formValidate.applyOrg,callback:function(t){e.$set(e.formValidate,"applyOrg",t)},expression:"formValidate.applyOrg"}})],1),e._v(" "),i("FormItem",{attrs:{label:"绑定企业",prop:"bindingOrg"}},[i("Input",{staticClass:"noEdit",attrs:{placeholder:"请获取绑定企业"},model:{value:e.formValidate.bindingOrg,callback:function(t){e.$set(e.formValidate,"bindingOrg",t)},expression:"formValidate.bindingOrg"}})],1),e._v(" "),i("FormItem",{attrs:{label:"证书序列号",prop:"serialNum"}},[i("Input",{staticClass:"noEdit",attrs:{placeholder:"请获取正确序列号"},model:{value:e.formValidate.serialNum,callback:function(t){e.$set(e.formValidate,"serialNum",t)},expression:"formValidate.serialNum"}}),e._v(" "),e.showxlh?i("div",{staticClass:"xlh",on:{click:e.getSerial}},[e._v("获取序列号")]):e._e()],1),e._v(" "),i("FormItem",{attrs:{label:"通用名校验",prop:"interest"}},[i("CheckboxGroup",{model:{value:e.formValidate.interest,callback:function(t){e.$set(e.formValidate,"interest",t)},expression:"formValidate.interest"}},[i("Checkbox",{attrs:{label:"（校验企业/机构名称与绑定企业是否一致）"}})],1)],1),e._v(" "),i("FormItem",{attrs:{label:"有效期",prop:"express"}},[i("Input",{staticClass:"noEdit",attrs:{placeholder:"请获取正确有效期"},model:{value:e.formValidate.express,callback:function(t){e.$set(e.formValidate,"express",t)},expression:"formValidate.express"}})],1),e._v(" "),e.showSave?i("FormItem",{staticStyle:{"text-align":"center"}},[i("div",[i("p",{staticClass:"errRemindBindCa"},[e._v(e._s(e.cabind_error))])]),e._v(" "),i("Button",{staticStyle:{width:"150px"},attrs:{type:"primary"},on:{click:function(t){e.bindCas("formValidates")}}},[e._v("保存")])],1):e._e()],1):e._e(),e._v(" "),e.showTipMsg?i("div",{staticClass:"talignc",attrs:{slot:"footer",id:"calerrordiv"},slot:"footer"},[i("div",[e._v(e._s(e.caL_errMsg))])]):e._e(),e._v(" "),e.showTD?i("div",{attrs:{id:"caBindNext"}},[i("div",{staticClass:"setsuctitle"},[i("span",[e._v("恭喜您！CA绑定成功，请继续完善资料！")])]),e._v(" "),i("div",{staticClass:"setsuctip"},[i("span",[e._v("系统将在")]),i("span",{staticClass:"textred"},[e._v(e._s(e.fsecond))]),e._v("秒后自动自动回关闭绑定页面")])]):e._e()],1)},staticRenderFns:[]};var m={name:"RegisterSuccess",data:function(){return{showMode:!1,org:this.$route.query.mode,modal1:!1,withdrawState:!1,screenHeight:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}},components:{bindCa:i("vSla")(d,u,!1,function(e){i("biPh")},"data-v-a64b405e",null).exports},mounted:function(){var e=this;e.init(),window.onresize=function(){return window.screenHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,void(e.screenHeight=window.screenHeight)}},computed:n()({},Object(o.c)(["org_status"])),methods:n()({},Object(o.b)(["getOrgStatus","revoke","loginOut","validBindCa"]),{closeOpBCa:function(){this.showMode=!1},opBCa:function(){var e=this;this.showMode=!1,this.validBindCa().then(function(e){if(console.log("已经绑定CA："+a()(e)),e.success){e.content;window.location.href="/dws/ocs/main/menu"}},function(t){console.log("未绑定CA："+a()(t)),e.showMode=!0})},relogin:function(){this.loginOut(),this.$router.push("/login")},viewInfo:function(){1==this.org?this.$router.push("/register1?look=1"):this.$router.push("/register?look=1")},goToLogin:function(){this.$router.push("/login")},init:function(){var e=this;setTimeout(function(){var t=document.getElementById("header").offsetHeight,i=document.getElementById("footer").offsetHeight,s=e.$refs.containerC.offsetHeight,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=t+i+s;if(r<a){var n=a-r;e.$refs.containerC.style.marginTop=n/2+"px",e.$refs.containerC.style.marginBottom=n/2+"px"}else e.$refs.containerC.style.marginTop="43px",e.$refs.containerC.style.marginBottom="43px"},0)},ok:function(){var e=this,t=document.getElementById("usernames").innerText;this.revoke({username:t}).then(function(t){t.success&&(e.withdrawState=!0)}),1==this.org?this.$router.push("/register1?reset=1&flag=0"):this.$router.push("/register?reset=1&flag=0")},cancel:function(){}}),watch:{screenHeight:function(e){this.init()}}},f={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"register-success"},[i("div",{ref:"containerC",staticClass:"container"},[i("div",{staticClass:"success-image"},[i("Icon",{staticClass:"iconC",attrs:{type:"checkmark-circled"}})],1),e._v(" "),i("div",{staticClass:"success-text"},[e._v("恭喜您！注册成功")]),e._v(" "),i("div",{staticClass:"success-text-note"},[i("p",[e._v("登录账号："),i("span",{attrs:{id:"usernames"}},[e._v(e._s(e.org_status.account))])])]),e._v(" "),i("div",{staticClass:"success-line"}),e._v(" "),i("div",{staticClass:"success-btnM"},[e.withdrawState?e._e():i("Button",{staticClass:"btnM-bt",attrs:{type:"primary"},on:{click:e.relogin}},[e._v("返回登录")]),e._v(" "),i("Button",{staticClass:"btnM-bt",on:{click:e.opBCa}},[e._v("\r\n        完善资料\r\n      ")])],1)]),e._v(" "),i("Modal",{attrs:{title:"操作确认","class-name":"vertical-center-modal"},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.modal1,callback:function(t){e.modal1=t},expression:"modal1"}},[i("p",[e._v("确认撤回当前待审核信息，重新提交？")])]),e._v(" "),e.showMode?i("div",[i("bind-ca")],1):e._e()],1)},staticRenderFns:[]};var h=i("vSla")(m,f,!1,function(e){i("rHoA")},null,null);t.default=h.exports},biPh:function(e,t){},rHoA:function(e,t){}});
//# sourceMappingURL=7.c3d707bf76dad146c743.js.map