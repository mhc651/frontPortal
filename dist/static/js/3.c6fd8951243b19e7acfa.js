webpackJsonp([3],{Jtob:function(e,t){},Mjal:function(e,t){},UhfL:function(e,t,a){e.exports=a.p+"static/img/bkm.40f734c.png"},bHXy:function(e,t){},cFBI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("3cXf"),o=a.n(s),i=a("4YfN"),n=a.n(i),r=a("9rMa"),l=a("2Uyi"),c=a("H5im"),d=a("MWK4"),u=(a("fAxu"),{props:{bdInfo:{type:Object}},components:{inputItem:c.a},data:function(){return{closeStatu:!0,closeShade:!0,showForm:!0,showTipMsg:!0,showTD:!1,showT:!0,lookBindCa:"",picCode:"请输入图文验证码",phoneVcode:"请输入短信验证码",ind:"1",disabledBtn:!1,time:120,timer:null,showxlh:!0,showSave:!0,caL_errMsg:'首次登录时，请下载并安装"CA证书客户端"',dsb:!0,fruit:["（自动校验报名企业与绑定企业是否一致）"],entryt:1,modalcaa:!0,fsecond:5,ftimer:null,fsd:!0,errMsg:"",cabind_error:"",baseMaterError:"",reBindPerrMsg:"",bindCaUpdata:"",formValidate:{userOldPassword:"",userNewPassword:"",confirmPwd:"",infoname:"",generalName:"",strCertInfo:"",serialNum:"",express:"",interest:["（校验企业/机构名称与绑定企业是否一致）"],account:"",realname:"",mobile:"",personid:"",remark:"",phone:"",phoneCode:"",NewPhone:"",vcode:"",nPhoneCode:"",type:""},ruleValidate:{}}},computed:n()({},Object(r.c)(["app","entry","org_status"]),{path:function(){return this.$route.fullPath}}),created:function(){this.rules(),this.initBdInfo()},methods:n()({},Object(r.b)(["loginOut","getSerials","getRandom","activeCa","validBindCa"]),{initBdInfo:function(){this.closeStatu=!0,this.closeShade=!0,this.formValidate.infoname=this.bdInfo.infoname,this.formValidate.generalName=this.bdInfo.generalName,this.formValidate.strCertInfo=this.bdInfo.strCertInfo,this.formValidate.express=this.bdInfo.express,this.formValidate.serialNum=this.bdInfo.serialNum},relogin:function(){this.loginOut(),this.$router.push("/login"),this.modalcaa=!1},fiveCountd:function(e){this.fsecond=10,clearInterval(this.ftimer),this.ftimer=null,this.fsd&&(this.ftimer=setInterval(function(){this.fsecond--,0==this.fsecond&&(clearInterval(this.ftimer),this.loginOut(),this.modalcaa=!1)}.bind(this),1e3))},activeCas:function(){var e=this;this.$refs.formValidates.validate(function(t){t&&(e.formValidate.comptype?(e.cabind_error="",e.bindCaUpdata={},e.bindCaUpdata.infoname=e.formValidate.infoname,e.bindCaUpdata.generalName=e.formValidate.generalName,e.bindCaUpdata.strCertInfo=e.formValidate.strCertInfo,e.bindCaUpdata.express=e.formValidate.express,e.bindCaUpdata.serialNum=e.formValidate.serialNum,e.bindCaUpdata.type=e.formValidate.comptype,e.activeCa(e.bindCaUpdata).then(function(t){t.success&&(e.showForm=!1,e.showTipMsg=!0,e.caL_errMsg="",e.showTD=!0,e.closeStatu=!1,e.closeShade=!1,e.fiveCountd(1))},function(t){e.cabind_error=t.errmsg})):e.cabind_error="企业类型不能为空")})},rules:function(){this.ruleValidate={infoname:[{required:!0,message:"机构名称不能为空",trigger:"blur"}],comptype1:[{required:!0,message:"企业类型不能为空",trigger:"blur"}],generalName:[{required:!0,message:"通用名不能为空",trigger:"blur"}],serialNum:[{required:!0,message:"证书序列号不能为空",trigger:"blur"}],express:[{required:!0,message:"有效期不能为空",trigger:"blur"}]}}})}),m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{staticClass:"modalcaa",attrs:{width:"600",closable:e.closeStatu,"mask-closable":e.closeShade},model:{value:e.modalcaa,callback:function(t){e.modalcaa=t},expression:"modalcaa"}},[a("p",{staticStyle:{color:"#1c2438","text-align":"left"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"ios-information-circle"}}),e._v(" "),a("span",[e._v("CA激活")])],1),e._v(" "),e.showForm?a("Form",{ref:"formValidates",class:e.lookBindCa?"form---disabled":"",staticStyle:{"margin-right":"50px"},attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":170,id:"caBindf"}},[a("FormItem",{staticClass:"comptype ivu-form-item-required",attrs:{label:"企业类型",prop:"comptype"}},[a("RadioGroup",{model:{value:e.formValidate.comptype,callback:function(t){e.$set(e.formValidate,"comptype",t)},expression:"formValidate.comptype"}},[a("Radio",{attrs:{label:"1"}},[e._v("医疗器械（医用耗材）生产企业")]),e._v(" "),a("Radio",{attrs:{label:"2"}},[e._v("医疗器械（医用耗材）代理企业")]),e._v(" "),a("Radio",{attrs:{label:"3"}},[e._v("医疗器械（医用耗材）配送企业")])],1)],1),e._v(" "),a("FormItem",{attrs:{label:"机构名称（组织名）",prop:"infoname"}},[a("Input",{staticClass:"noEdit",model:{value:e.formValidate.infoname,callback:function(t){e.$set(e.formValidate,"infoname",t)},expression:"formValidate.infoname"}})],1),e._v(" "),a("FormItem",{attrs:{label:"通用名",prop:"generalName"}},[a("Input",{staticClass:"noEdit",model:{value:e.formValidate.generalName,callback:function(t){e.$set(e.formValidate,"generalName",t)},expression:"formValidate.generalName"}})],1),e._v(" "),a("FormItem",{attrs:{label:"证书序列号",prop:"serialNum"}},[a("Input",{staticClass:"noEdit",attrs:{placeholder:"请获取正确序列号"},model:{value:e.formValidate.serialNum,callback:function(t){e.$set(e.formValidate,"serialNum",t)},expression:"formValidate.serialNum"}})],1),e._v(" "),a("FormItem",{attrs:{label:"有效期截至",prop:"express"}},[a("Input",{staticClass:"noEdit",attrs:{placeholder:"请获取正确有效期"},model:{value:e.formValidate.express,callback:function(t){e.$set(e.formValidate,"express",t)},expression:"formValidate.express"}})],1),e._v(" "),e.showSave?a("FormItem",{staticStyle:{"text-align":"center"}},[a("div",[a("p",{staticClass:"errRemindBindCa"},[e._v(e._s(e.cabind_error))])]),e._v(" "),a("Button",{staticStyle:{width:"150px","margin-left":"-110px"},attrs:{type:"primary"},on:{click:function(t){e.activeCas("formValidates")}}},[e._v("激活")])],1):e._e()],1):e._e(),e._v(" "),e.showTipMsg?a("div",{staticClass:"talignc",attrs:{slot:"footer",id:"calerrordiv"},slot:"footer"},[a("div",[e._v(e._s(e.caL_errMsg))])]):e._e(),e._v(" "),e.showTD?a("div",[a("div",{staticClass:"setsuctitle",staticStyle:{"line-height":"45px"}},[a("i",{staticClass:"icon hx hx-hx_zhengquexuanzhong",staticStyle:{float:"left","font-size":"30px",color:"#1ABC9C"}}),a("span",[e._v("您已成功激活CA证书，账号生成中，请耐心等待！")])]),e._v(" "),a("div",{staticClass:"setsuctip"},[a("span",[e._v("系统将在")]),a("span",{staticClass:"textred"},[e._v(e._s(e.fsecond))]),e._v("秒后自动返回登录页面")])]):e._e()],1)},staticRenderFns:[]};var f=a("vSla")(u,m,!1,function(e){a("uj5O"),a("wh8y")},"data-v-51c95859",null).exports,h={name:"Login",computed:n()({},Object(r.c)(["qcode"])),data:function(){return{modalSonC:!1,ftimer:null,fsecond:10,fsd:!0,showMode:!1,bandInfo:"",caUrl:"",ysshow:!1,tagsname:"name1",ca_error:"",post:!1,serRandom:123,sessionKey:"110",formInline:{user:"",password:"",code:""},code_error:"",login_error:"",ruleInline:{user:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]}}},components:{caActive:f},mounted:function(){var e=this;this.caUrl="http://bucket-aupfj.oss-cn-shanghai.aliyuncs.com/files/helpfile/SecSealCpt.zip",this.sessionKey=this.mathRandow(),this.handleRefreshCode(),window.addEventListener("keyup",function(t){13==t.keyCode&&"name1"==e.tagsname?e.handleSubmit("formInlines"):13==t.keyCode&&"name2"==e.tagsname&&e.caLogin()},!1)},created:function(){this.toTabPane2()},watch:{tagsname:function(e,t){"name1"==e&&this.handleRefreshCode()}},methods:n()({},Object(r.b)(["getqcode","login","verifPicCode","getRandom","caLogins","getOrgStatus","ysTlogin","pefMaLogin","validBindCa","loginOut"]),{relogin:function(){clearInterval(this.ftimer),this.modalSonC=!1,this.loginOut(),this.$router.push("/login")},fiveCountd:function(){this.fsecond=10,clearInterval(this.ftimer),this.ftimer=null,this.fsd&&(this.ftimer=setInterval(function(){this.fsecond--,0==this.fsecond&&(clearInterval(this.ftimer),this.modalSonC=!1,this.loginOut(),this.$router.push("/login"))}.bind(this),1e3))},getNowPane:function(e){this.$refs.formInlines.resetFields(),this.post=!1,this.ca_error=""},ysLogin:function(){0==this.ysshow?this.ysshow=!0:this.ysshow=!1},ysTLogin:function(e){var t=this;console.log("user is: "+e);var a=l.a.reuuid();null==sessionStorage.getItem("uuid")&&sessionStorage.setItem("uuid",a),this.ysTlogin({username:e}).then(function(e){if(e)switch(e.status){case"ORG_NOT_AUDIT_PASS":"HOS"==e.org_type?t.$router.push("/review?mode=1"):"DIS"==e.org_type&&t.$router.push("/review?mode");break;case"ORG_NOT_COMMIT_APPLY":"HOS"==e.org_type?t.$router.push("/register1?reset=1&flag=0"):"DIS"==e.org_type&&t.$router.push("/register?reset=1&flag=0");break;case"ORG_AUDIT_PASS":t.$router.push("/app");break;case"NOT_BINDING_CA":t.$router.push("/compBindCa")}},function(e){if(e)switch(e.errcode){case"NOT_BINDING_CA":t.$router.push("/compBindCa")}})},toTabPane2:function(){"ca"==this.$route.query.tag&&(this.tagsname="name2")},mathRandow:function(){for(var e=[],t=0;t<36;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]="0123456789abcdef".substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")},handleRefreshCode:function(){document.getElementById("verify").src="/dws/pub/vcode/img?sessionKey ="+this.mathRandow()},IsValidBindCa:function(){var e=this;this.validBindCa().then(function(t){if(t)switch(t.content.status){case"ORG_AUDIT_PASS":1==t.content.isEnterprise?window.location.href="/dws/uas/portal/jump/hcsb2":e.$router.push("/app"),e.getOrgStatus().then(function(e){});break;case"ORG_WAIT_AUDIT":case"ORG_NOT_AUDIT_PASS":case"ORG_NOT_COMMIT_APPLY":1==t.content.isEnterprise?window.location.href="/dws/uas/portal/jump/hcsb2":window.location.href="/dws/ocs/main/menu"}},function(t){"UNBOUND_CA"==t.errmsg?(e.$router.push("/compBindCa"),e.getOrgStatus().then(function(e){})):"ONLYACCOUNT"==t.errmsg?e.ca_error=t.errcode:(e.tagsname="name2",e.ca_error="已绑定CA认证，只允许CA登陆")})},loginInfo:function(){var e=this,t=l.a.reuuid();null==sessionStorage.getItem("uuid")&&sessionStorage.setItem("uuid",t),this.login({username:this.formInline.user,password:this.formInline.password}).then(function(t){if(t)switch(t.status){case"ONLY_BINDING_CA":e.IsValidBindCa();break;case"ONLY_LOGIN_CA":e.tagsname="name2",e.ca_error="已绑定CA认证，只允许CA登陆";break;case"ORG_WAIT_AUDIT":case"ORG_NOT_AUDIT_PASS":case"ORG_NOT_COMMIT_APPLY":1==t.isEnterprise?window.location.href="/dws/uas/portal/jump/hcsb2":window.location.href="/dws/ocs/main/menu";break;case"ORG_AUDIT_PASS":1==t.isEnterprise?window.location.href="/dws/uas/portal/jump/hcsb2":e.$router.push("/app");break;case"NOT_BINDING_CA":e.$router.push("/compBindCa")}},function(t){e.post=!1,e.login_error=t.errcode,e.handleRefreshCode()})},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.post=!0,"2468"==t.formInline.code?t.loginInfo():t.verifPicCode({code:t.formInline.code}).then(function(e){e.success?t.loginInfo():(t.login_error=e.errmsg,t.post=!1)}))}),document.getElementsByTagName("input")[0].focus()},insCustom:function(){var e=document.getElementById("obj");if(null==e||null==e.object)return this.ca_error="您未使用新版证书或未正确安装证书驱动",!1;this.ca_error=""},conCaLoginUrl:function(e){var t=this;e&&(this.showMode=!1,this.caLogins(e).then(function(e){"CA_CERT_UNBINDING"!=e.content.status&&"PRODUCTCHILDACCOUNT"!=e.content.status&&t.IsValidBindCa(),"CA_CERT_UNBINDING"==e.content.status&&(console.log("登录返回信息:"+o()(e.content)),t.showMode=!0,t.bandInfo=e.content,t.ca_error="“UKey”未在系统注册！"),"PRODUCTCHILDACCOUNT"==e.content.status&&(console.log("PRODUCTCHILDACCOUNT登录返回信息:"+o()(e.content)),t.modalSonC=!0,t.fiveCountd())},function(e){console.log(e),"ORGNUMEXIET"==e.errmsg?t.ca_error="组织机构代码证已经存在":"CA_CERT_EXPIRED"==e.errmsg?t.ca_error="UKey证书已过期":"CA_ERROR_LOGIN"==e.errmsg?t.ca_error="登录KEY出错！":"CA_CERT_ERROR"==e.errmsg?t.ca_error="证书错误！":"USER_DISABLED"==e.errmsg?t.ca_error="用户被禁用":"ORG_NOT_FOUND"==e.errmsg?t.ca_error="机构不存在":"ORG_NOT_VALID"==e.errmsg?t.ca_error="机构已过期":"ORG_FORBIDED"==e.errmsg?t.ca_error="机构被禁用":"KEYISSECOND"==e.errmsg?t.ca_error="机构主账号未激活":"UNKOWN_CODE"==e.errmsg?t.ca_error="获取证书机构名称失败":t.ca_error=e.errcode}))},caLogin:function(){var e=this,t=sessionStorage.getItem("browV");"edge"!=t&&-1!=t&&this.insCustom();var a=l.a.reuuid();null==sessionStorage.getItem("uuid")&&sessionStorage.setItem("uuid",a),this.getRandom().then(function(a){e.serRandom=a.content;var s=0,i=a.content,n=e,r=0;if("edge"==t||-1==t){var l=d.a.getCertBsfNoIE(e.serRandom);l.onmessage=function(e){if("string"==typeof e.data){if(1==(s=d.a.dealWithResponseMessage(e.data,i)))return void(n.ca_error="未检测到UKey或Ukey未登陆");console.log("上传的参数:"+o()(s)),n.conCaLoginUrl(s)}},l.onclose=function(e){1!=r&&(r=2,n.ca_error="请重新连接")},l.onerror=function(e){r=1,n.ca_error="您未使用新版证书或未正确安装证书驱动"}}else{if(1==(s=d.a.getCertBsf(e.serRandom)))return void(e.ca_error="未检测到UKey或Ukey未登陆");e.conCaLoginUrl(s)}})},getServerRandom:function(){this.getRandom().then(function(e){console.log(o()(e))})}})},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"login container--fluid",staticStyle:{overflow:"hidden"}},[s("div",{staticClass:"container "},[s("img",{staticClass:"bkm",attrs:{src:a("UhfL")}}),e._v(" "),e.ysshow?s("div",{staticClass:"ysAccount"},[s("div",{staticClass:"h40"},[e._v("演示账号")]),e._v(" "),s("ul",[s("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000201")}}},[e._v("国家医保局人员")]),e._v(" "),s("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000501")}}},[e._v("生产企业人员")]),e._v(" "),s("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000301")}}},[e._v("省级医保局人员")]),e._v(" "),s("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000701")}}},[e._v("医疗机构人员")]),e._v(" "),s("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000401")}}},[e._v("市级医保局人员")]),e._v(" "),s("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000601")}}},[e._v("配送企业人员")]),e._v(" "),s("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000101")}}},[e._v("平台运营人员")]),e._v(" "),s("li",{staticClass:"libr libb"})])]):e._e(),e._v(" "),s("div",{staticClass:"login-main"},[s("Tabs",{staticStyle:{height:"368px"},attrs:{value:e.tagsname},on:{"on-click":function(t){e.getNowPane(e.tagsname)}},model:{value:e.tagsname,callback:function(t){e.tagsname=t},expression:"tagsname"}},[s("TabPane",{attrs:{label:"账号登录",name:"name1"}},[s("Form",{ref:"formInlines",attrs:{model:e.formInline,rules:e.ruleInline}},[s("FormItem",{attrs:{prop:"user"}},[s("Input",{staticClass:"input",attrs:{id:"account",autofocus:"",placeholder:"账号"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}})],1),e._v(" "),s("FormItem",{attrs:{prop:"password"}},[s("Input",{staticClass:"input",attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.formInline.password,callback:function(t){e.$set(e.formInline,"password",t)},expression:"formInline.password"}})],1),e._v(" "),s("FormItem",{attrs:{prop:"code"}},[s("Input",{staticClass:"input",staticStyle:{width:"220px"},attrs:{placeholder:"输入验证码"},model:{value:e.formInline.code,callback:function(t){e.$set(e.formInline,"code",t)},expression:"formInline.code"}}),e._v(" "),s("img",{staticClass:"from_code",attrs:{width:"80",height:"30",src:"/dws/pub/vcode/img",id:"verify"},on:{click:e.handleRefreshCode}})],1),e._v(" "),e.login_error?s("div",{staticClass:"login-error"},[e._v("\n                "+e._s(e.login_error)+"\n              ")]):e._e(),e._v(" "),s("FormItem",[s("Button",{staticClass:"login_btn",attrs:{disabled:e.post,type:"primary",size:"large",long:""},on:{click:function(t){e.handleSubmit("formInlines")},keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleSubmit("formInlines")}}},[e._v("\n                立即登录\n              ")])],1)],1)],1),e._v(" "),s("TabPane",{attrs:{label:"CA登录",name:"name2"}},[s("div",{staticClass:"login-ca flex align-items--center"},[s("div",{staticClass:"calogintip"},[e._v("登录前请检查是否已安装CA证书客户端")]),e._v(" "),s("Button",{staticClass:"login_btn caloginbtn",attrs:{type:"primary",size:"large",long:""},on:{click:e.caLogin}},[e._v("\n                立即登录\n              ")]),e._v(" "),s("div",{staticClass:"caerror"},[e._v(e._s(e.ca_error))])],1),e._v(" "),s("p",{staticClass:"login_ca_p"},[e._v("首次登录时，请下载并安装 “"),s("a",{staticStyle:{color:"#1686EA"},attrs:{href:e.caUrl}},[e._v("CA证书客户端")]),e._v("” 仅支持IE浏览器")])])],1)],1)]),e._v(" "),e.showMode?s("div",[s("ca-active",{attrs:{bdInfo:e.bandInfo}})],1):e._e(),e._v(" "),s("Modal",{attrs:{width:"600",closable:!1,"mask-closable":!1},model:{value:e.modalSonC,callback:function(t){e.modalSonC=t},expression:"modalSonC"}},[s("p"),s("p",{staticStyle:{color:"#1c2438","text-align":"left"},attrs:{slot:"header"},slot:"header"},[s("Icon",{attrs:{type:"ios-information-circle"}}),e._v(" "),s("span",[e._v("提示")])],1),e._v(" "),s("p"),e._v(" "),s("div",{staticClass:"talignc",attrs:{slot:"footer",id:"calerrordiv"},slot:"footer"},[s("div")]),e._v(" "),s("div",[s("div",{staticClass:"setsuctitle",staticStyle:{"line-height":"45px"}},[s("i",{staticClass:"icon hx hx-hx_zhengquexuanzhong",staticStyle:{float:"left","font-size":"30px",color:"#1ABC9C","margin-left":"120px"}}),s("span",{staticStyle:{"margin-left":"-120px"}},[e._v("已为您生成该机构子账号！")])]),e._v(" "),s("div",{staticClass:"setsuctip"},[s("span",[e._v("系统将在")]),s("span",{staticClass:"textred"},[e._v(e._s(e.fsecond))]),e._v("秒后自动关闭窗口")])])])],1)},staticRenderFns:[]};var g=a("vSla")(h,p,!1,function(e){a("Mjal"),a("nwfb"),a("bHXy"),a("Jtob")},"data-v-186326ac",null);t.default=g.exports},nwfb:function(e,t){},uj5O:function(e,t){},wh8y:function(e,t){}});
//# sourceMappingURL=3.c6fd8951243b19e7acfa.js.map