webpackJsonp([6],{"5z0X":function(e,t){},D3dc:function(e,t){},EurL:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),s=a.n(i),r=a("4YfN"),n=a.n(r),o=a("9rMa"),l=a("H5im"),d=a("fAxu"),c=a("MWK4"),m={name:"NewPassword",components:{inputItem:l.a},data:function(){return{cabind_error:"",caL_errMsg:'首次登录时，请下载并安装"CA证书客户端"，仅支持IE浏览器。',bindCaUpdata:"",picCode:"请输入图文验证码",phoneVcode:"请输入短信验证码",ind:1,username:0,fsecond:5,ftimer:null,fsd:!0,clientHeight:"500",src:"",disabledBtn:!1,time:180,timer:null,err:!1,errMsg:"",reviewUrl:"",formValidate:{cardNo:"",vcode:"",phone:"",phoneCode:"",name:"",applyOrg:"",bindingOrg:"",serialNum:"",express:"",interest:["（校验企业/机构名称与绑定企业是否一致）"]},ruleValidate:{cardNo:[{required:!0,message:"身份证号码不能为空",trigger:"blur"},{validator:d.a.validateIdCard,trigger:"blur"}],phone:[{required:!0,message:"手机号码不能为空",trigger:"blur"},{validator:d.a.validatePhone,trigger:"blur"}],vcode:[{required:!0,message:"图片验证码不能为空",trigger:"blur"}],phoneCode:[{required:!0,message:"验证码不能为空",trigger:"blur"}]}}},computed:n()({},Object(o.c)(["app","qcode"])),methods:n()({},Object(o.b)(["getPCodeBindCa","getqcode","resetpwd","validatePhoneCa","verifPicCode"]),{mathRandow:function(){for(var e=[],t=0;t<36;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]="0123456789abcdef".substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")},handleRefreshCode:function(){document.getElementById("verify").src="/dws/pub/vcode/img?sessionKey ="+this.mathRandow()},getNumCode:function(){if(!/(^1[3|4|5|7|8]\d{9}$)|(^09\d{8}$)/.test(this.formValidate.phone))return!1;this.disabledBtn=!this.disabledBtn,this.time=120,clearInterval(this.timer),this.timer=null,this.disabledBtn&&(this.timer=setInterval(function(){this.time--,0===this.time&&(this.disabledBtn=!this.disabledBtn,this.time=120,clearInterval(this.timer))}.bind(this),1e3)),this.getPCodeBindCa({mobile:this.formValidate.phone}).then(function(e){e.success})},fiveCountd:function(){this.fsecond=5,clearInterval(this.ftimer),this.ftimer=null,this.fsd&&(this.ftimer=setInterval(function(){this.fsecond--,0==this.fsecond&&(clearInterval(this.ftimer),this.$router.push("/login"))}.bind(this),1e3))},insCustom:function(){var e=document.getElementById("obj");if(null==e||null==e.object)return this.cabind_error="您未使用新版证书或未正确安装证书驱动",!1;this.cabind_error=""},getSerial:function(){var e=this;this.insCustom(),this.getRandom().then(function(t){console.log(t),e.serRandom=t.content;var a=c.a.getCertBsf(e.serRandom);console.log("1"+s()(a)),a&&e.getSerials(a).then(function(t){if(t.success){console.log("2"+s()(t.content));var i=t.content;e.formValidate.bindingOrg=i.generalName,e.formValidate.serialNum=i.serialNum,e.formValidate.express=i.express,a.applyOrg=e.formValidate.applyOrg,a.bindingOrg=e.formValidate.bindingOrg,a.serialNum=e.formValidate.serialNum,a.express=e.formValidate.express,a.username=e.formValidate.name,e.bindCaUpdata=a}})})},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(e)if(1==t.ind){var a={mobile:t.formValidate.phone,scode:t.formValidate.phoneCode};t.ind=2,t.verifPicCode({code:t.formValidate.vcode}).then(function(e){e.success?t.validatePhoneCa(a).then(function(e){e.success?(t.ind=2,t.username=e.content,document.getElementById("twoth").setAttribute("class","comC nowC"),t.errMsg=""):(t.errMsg=e.errmsg,t.handleRefreshCode())}):t.errMsg=e.errmsg})}else 2==t.ind&&t.$refs.formValidates.validate(function(e){e&&(t.formValidate.interest.length>0?t.bindCaUpdata.check=1:t.bindCaUpdata.check=2,t.bindCaUpdata.type="login",t.bindCa(t.bindCaUpdata).then(function(e){console.log(s()(e)),e.success&&(document.getElementById("caBindNext").removeAttribute("class","dispnone"),document.getElementById("caBindNext").setAttribute("class","hmid cont"),document.getElementById("caBindf").style.display="none",document.getElementById("calerrordiv").style.display="none",t.fiveCountd(1))},function(e){t.cabind_error=e.errmsg}))})})},setHeight:function(){if(document.documentElement.clientHeight<=768)this.clientHeight="498px";else{var e=document.getElementsByTagName("footer")[0].clientHeight;console.log("footer height is: "+e),this.clientHeight=document.documentElement.clientHeight-e-91-30+"px"}}}),mounted:function(){this.handleRefreshCode(),this.setHeight();var e=this;window.onresize=function(){e.setHeight()}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main--fluid centers"},[a("div",{staticClass:"main",style:"height:"+e.clientHeight,attrs:{id:"fpw"}},[a("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":245}},[a("table",{staticClass:"ititle"},[a("thead",[(1==e.ind?e.classNow="nowC":e.classNow="passC")?a("th",{staticClass:"nowC comC",class:e.classNow},[a("div",[e._v("1")]),a("span",[e._v("手机验证")])]):e._e(),e._v(" "),(2==e.ind?e.classNow="nowC":e.classNow="passC")?a("th",{staticClass:"defaultC comC",attrs:{id:"twoth"}},[a("div",[e._v("2")]),a("span",[e._v("CA绑定")])]):e._e(),e._v(" "),(3==e.ind?e.classNow="nowC":e.classNow="passC")?a("th",{staticClass:"defaultC comC",attrs:{id:"threeth"}},[a("div",[e._v("3")]),a("span",[e._v("完成")])]):e._e()])]),e._v(" "),a("div",{staticStyle:{"margin-top":"30px"}},[1==e.ind?a("div",[a("inputItem",{ref:"phone",attrs:{labelVal:{label:"手机号"},model:e.formValidate,prop:"phone",plh:"请输入您的手机号"}}),e._v(" "),a("div",{staticClass:"verificationCode publicInput"},[a("FormItem",{staticClass:"formItem",attrs:{label:"验证码：",prop:"vcode"}},[a("div",{staticClass:"NumCode inputvcode"},[a("Input",{staticClass:"fleft",attrs:{type:"text",placeholder:e.picCode},model:{value:e.formValidate.vcode,callback:function(t){e.$set(e.formValidate,"vcode",t)},expression:"formValidate.vcode"}}),e._v(" "),a("img",{staticClass:"from_codes",attrs:{width:"80",height:"30",src:"/dws/pub/vcode/img",id:"verify"},on:{click:e.handleRefreshCode}})],1)])],1),e._v(" "),a("div",{staticClass:"verificationCode publicInput"},[a("FormItem",{staticClass:"formItem",attrs:{label:"短信验证码：",prop:"phoneCode"}},[a("div",{staticClass:"NumCode"},[a("Input",{attrs:{type:"text",placeholder:e.phoneVcode},model:{value:e.formValidate.phoneCode,callback:function(t){e.$set(e.formValidate,"phoneCode",t)},expression:"formValidate.phoneCode"}}),e._v(" "),a("Button",{directives:[{name:"show",rawName:"v-show",value:e.disabledBtn,expression:"disabledBtn"}],attrs:{disabled:""}},[e._v(e._s(e.time)+"s后可重新获取")]),e._v(" "),a("Button",{directives:[{name:"show",rawName:"v-show",value:!e.disabledBtn,expression:"!disabledBtn"}],on:{click:e.getNumCode}},[e._v("获取验证码")])],1),e._v(" "),a("label",{staticClass:"rightTip text-center"},[e._v("请于2分钟内查收手机短信，并填写短信中的验证码")])])],1)],1):e._e(),e._v(" "),2==e.ind?a("div",{staticClass:"modal3"},[a("Form",{ref:"formValidates",staticClass:"hmid cont",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":90,id:"caBindf"}},[a("FormItem",{attrs:{label:"账号",prop:"name"}},[a("Input",{model:{value:e.formValidate.name,callback:function(t){e.$set(e.formValidate,"name",t)},expression:"formValidate.name"}})],1),e._v(" "),a("FormItem",{attrs:{label:"报名企业",prop:"applyOrg"}},[a("Input",{model:{value:e.formValidate.applyOrg,callback:function(t){e.$set(e.formValidate,"applyOrg",t)},expression:"formValidate.applyOrg"}})],1),e._v(" "),a("FormItem",{attrs:{label:"绑定企业",prop:"bindingOrg"}},[a("Input",{model:{value:e.formValidate.bindingOrg,callback:function(t){e.$set(e.formValidate,"bindingOrg",t)},expression:"formValidate.bindingOrg"}})],1),e._v(" "),a("FormItem",{attrs:{label:"证书序列号",prop:"serialNum"}},[a("Input",{model:{value:e.formValidate.serialNum,callback:function(t){e.$set(e.formValidate,"serialNum",t)},expression:"formValidate.serialNum"}}),e._v(" "),a("div",{staticClass:"xlh",on:{click:e.getSerial}},[e._v("获取序列号")])],1),e._v(" "),a("FormItem",{attrs:{label:"通用名校验",prop:"interest"}},[a("CheckboxGroup",{model:{value:e.formValidate.interest,callback:function(t){e.$set(e.formValidate,"interest",t)},expression:"formValidate.interest"}},[a("Checkbox",{attrs:{label:"（校验企业/机构名称与绑定企业是否一致）"}})],1)],1),e._v(" "),a("FormItem",{attrs:{label:"有效期",prop:"express"}},[a("Input",{model:{value:e.formValidate.express,callback:function(t){e.$set(e.formValidate,"express",t)},expression:"formValidate.express"}})],1),e._v(" "),a("FormItem",[a("div",{staticStyle:{visibility:"visible"}},[a("p",{staticClass:"errRemind"},[e._v(e._s(e.cabind_error))])]),e._v(" "),a("Button",{staticStyle:{width:"150px","margin-left":"60px"},attrs:{type:"primary"},on:{click:function(t){e.bindCas("formValidates")}}},[e._v("保存")])],1),e._v(" "),a("div",{staticStyle:{"border-top":"1px solid #e9eaec"}},[a("div",{staticStyle:{padding:"12px 18px 12px 18px"}},[e._v(e._s(e.caL_errMsg))])])],1)],1):e._e(),e._v(" "),3==e.ind?a("div",[a("div",{staticClass:"congr"},[e._v("恭喜您！密码设置成功，请重新登录！")]),e._v(" "),a("div",{staticClass:"relogin"},[e._v("系统将在"),a("span",{staticClass:"textred"},[e._v(e._s(e.fsecond))]),a("span",[e._v("秒后自动调整至登录页面，您可以选择直接登陆")]),e._v(" "),a("router-link",{staticClass:"pull-right relot",attrs:{to:"/login"}},[e._v("返回登录")])],1)]):e._e()])]),e._v(" "),a("div",{staticClass:"registerWrap w1198"},[a("p",{staticClass:"errRemind"},[e._v(e._s(e.errMsg))]),e._v(" "),1==e.ind||2==e.ind?a("Button",{staticClass:"registerBtn",attrs:{type:"primary"},on:{click:function(t){e.handleSubmit("formValidate")}}},[e._v("下一步")]):e._e()],1)],1)])},staticRenderFns:[]};var f=a("vSla")(m,u,!1,function(e){a("PxNq"),a("5z0X"),a("D3dc")},"data-v-e70b92e8",null);t.default=f.exports},PxNq:function(e,t){}});
//# sourceMappingURL=6.87f7bc5739bfd3417feb.js.map