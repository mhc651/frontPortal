webpackJsonp([5],{"3AqX":function(e,t){},D7g7:function(e,t){},UhfL:function(e,t,s){e.exports=s.p+"static/img/bkm.40f734c.png"},cFBI:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("3cXf"),o=s.n(r),n=s("4YfN"),i=s.n(n),a=s("9rMa"),c=s("2Uyi"),l={name:"Login",computed:i()({},Object(a.c)(["qcode"])),data:function(){return{ysshow:!1,tagsname:"name1",ca_error:"",post:!1,serRandom:123,sessionKey:"110",formInline:{user:"",password:"",code:""},code_error:"",login_error:"",ruleInline:{user:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]}}},mounted:function(){this.sessionKey=this.mathRandow(),this.handleRefreshCode()},created:function(){this.toTabPane2()},methods:i()({},Object(a.b)(["getqcode","login","verifPicCode","getRandom","caLogins","getOrgStatus","ysTlogin"]),{ysLogin:function(){0==this.ysshow?this.ysshow=!0:this.ysshow=!1},ysTLogin:function(e){var t=this;console.log("user is: "+e);var s=c.a.reuuid();null==sessionStorage.getItem("uuid")&&sessionStorage.setItem("uuid",s),this.ysTlogin({username:e}).then(function(e){if(e)switch(e.status){case"ORG_NOT_AUDIT_PASS":"HOS"==e.org_type?t.$router.push("/review?mode=1"):"DIS"==e.org_type&&t.$router.push("/review?mode");break;case"ORG_NOT_COMMIT_APPLY":"HOS"==e.org_type?t.$router.push("/register1?reset=1&flag=0"):"DIS"==e.org_type&&t.$router.push("/register?reset=1&flag=0");break;case"ORG_AUDIT_PASS":t.$router.push("/app");break;case"NOT_BINDING_CA":t.$router.push("/compBindCa")}},function(e){if(e)switch(e.errcode){case"NOT_BINDING_CA":t.$router.push("/compBindCa")}})},toTabPane2:function(){"ca"==this.$route.query.tag&&(this.tagsname="name2")},mathRandow:function(){for(var e=[],t=0;t<36;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]="0123456789abcdef".substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")},handleRefreshCode:function(){document.getElementById("verify").src="/dws/pub/vcode/img?sessionKey ="+this.mathRandow()},loginInfo:function(){var e=this,t=c.a.reuuid();null==sessionStorage.getItem("uuid")&&sessionStorage.setItem("uuid",t),this.login({username:this.formInline.user,vcode:this.formInline.code,password:this.formInline.password}).then(function(t){if(t)switch(t.status){case"ORG_NOT_AUDIT_PASS":"HOS"==t.org_type?e.$router.push("/review?mode=1"):"DIS"==t.org_type&&e.$router.push("/review?mode");break;case"ORG_NOT_COMMIT_APPLY":"HOS"==t.org_type?e.$router.push("/register1?reset=1&flag=0"):"DIS"==t.org_type&&e.$router.push("/register?reset=1&flag=0");break;case"ORG_AUDIT_PASS":e.$router.push("/app");break;case"NOT_BINDING_CA":e.$router.push("/compBindCa")}},function(t){if(t)switch(t.errcode){case"NOT_BINDING_CA":e.$router.push("/compBindCa")}e.post=!1,e.login_error=t.errmsg,e.handleRefreshCode()})},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.post=!0,t.verifPicCode({code:t.formInline.code}).then(function(e){e.success?t.loginInfo():(t.login_error=e.errmsg,t.post=!1)}))})},getCertBsf:function(){var e;if(0==(t=obj.SOF_Login("",""))){if(""!=(t=obj.SOF_GetUserList())){var t,s=t.length;if(e=t.substr(s-"38","38"),""!=(t=obj.SOF_ExportUserCert(e))){var r=obj.SOF_SignData(e,this.serRandom);if(""!=r)return{strData:this.serRandom,strSign:r,strCert:t}}}}else this.ca_error="未检测到UKey或Ukey未登陆"},caLogin:function(){var e=this,t=document.getElementById("obj");if(null==t||null==t.object)return this.ca_error="您未使用新版证书或未正确安装证书驱动",!1;this.ca_error="";var s=c.a.reuuid();null==sessionStorage.getItem("uuid")&&sessionStorage.setItem("uuid",s),this.getRandom().then(function(t){e.serRandom=t.content;var s=e.getCertBsf();console.log("ca登陆上传参数: "+o()(s)),s&&e.caLogins(s).then(function(t){console.log(o()(t)),t.success&&(e.getOrgStatus().then(function(e){console.log("orgstatus: "+o()(e))}),e.$router.push("/app"))},function(t){console.log(t),"CA_CERT_UNBINDING"==t.errcode?e.ca_error="“UKey”未在系统注册！":"CA_CERT_EXPIRED"==t.errcode?e.ca_error="UKey证书已过期":"CA_ERROR_LOGIN"==t.errcode?e.ca_error="登录KEY出错！":"CA_CERT_ERROR"==t.errcode?e.ca_error="证书错误！":"USER_DISABLED"==t.errcode?e.ca_error="用户被禁用":"ORG_NOT_FOUND"==t.errcode?e.ca_error="机构不存在":"ORG_NOT_VALID"==t.errcode?e.ca_error="机构已过期":"ORG_FORBIDED"==t.errcode&&(e.ca_error="机构被禁用")})})},getServerRandom:function(){this.getRandom().then(function(e){console.log(o()(e))})}})},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"login container--fluid",staticStyle:{overflow:"hidden"}},[r("div",{staticClass:"container "},[r("img",{staticClass:"bkm",attrs:{src:s("UhfL")}}),e._v(" "),e.ysshow?r("div",{staticClass:"ysAccount"},[r("div",{staticClass:"h40"},[e._v("演示账号")]),e._v(" "),r("ul",[r("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000201")}}},[e._v("国家医保局人员")]),e._v(" "),r("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000501")}}},[e._v("生产企业人员")]),e._v(" "),r("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000301")}}},[e._v("省级医保局人员")]),e._v(" "),r("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000701")}}},[e._v("医疗机构人员")]),e._v(" "),r("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000401")}}},[e._v("市级医保局人员")]),e._v(" "),r("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000601")}}},[e._v("配送企业人员")]),e._v(" "),r("li",{staticClass:"libr libb",on:{click:function(t){e.ysTLogin("admin@00000101")}}},[e._v("平台运营人员")]),e._v(" "),r("li",{staticClass:"libr libb"})])]):e._e(),e._v(" "),r("div",{staticClass:"login-main"},[r("Tabs",{attrs:{value:e.tagsname}},[r("TabPane",{attrs:{label:"账号登录",name:"name1"}},[r("Form",{ref:"formInlines",attrs:{model:e.formInline,rules:e.ruleInline}},[r("FormItem",{attrs:{prop:"user"}},[r("Input",{staticClass:"input",attrs:{placeholder:"账号"},model:{value:e.formInline.user,callback:function(t){e.$set(e.formInline,"user",t)},expression:"formInline.user"}})],1),e._v(" "),r("FormItem",{attrs:{prop:"password"}},[r("Input",{staticClass:"input",attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.formInline.password,callback:function(t){e.$set(e.formInline,"password",t)},expression:"formInline.password"}}),e._v(" "),r("div",{staticClass:"fgpw"},[r("router-link",{staticClass:"pull-right",attrs:{to:"/newpassword"}},[e._v("忘记密码")])],1)],1),e._v(" "),r("FormItem",{attrs:{prop:"code"}},[r("Input",{staticClass:"input",staticStyle:{width:"220px"},attrs:{placeholder:"输入验证码"},model:{value:e.formInline.code,callback:function(t){e.$set(e.formInline,"code",t)},expression:"formInline.code"}}),e._v(" "),r("img",{staticClass:"from_code",attrs:{width:"80",height:"30",src:"/dws/pub/vcode/img",id:"verify"},on:{click:e.handleRefreshCode}})],1),e._v(" "),e.login_error?r("div",{staticClass:"login-error"},[e._v("\r\n                "+e._s(e.login_error)+"\r\n              ")]):e._e(),e._v(" "),r("FormItem",[r("Button",{staticClass:"login_btn",attrs:{disabled:e.post,type:"primary",size:"large",long:""},on:{click:function(t){e.handleSubmit("formInlines")},keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleSubmit("formInlines")}}},[e._v("\r\n                立即登录\r\n              ")])],1)],1)],1),e._v(" "),r("TabPane",{attrs:{label:"CA登录",name:"name2"}},[r("div",{staticClass:"login-ca flex align-items--center"},[r("div",{staticClass:"calogintip"},[e._v("登录前请检查是否已安装CA证书客户端")]),e._v(" "),r("Button",{staticClass:"login_btn caloginbtn",attrs:{type:"primary",size:"large",long:""},on:{click:e.caLogin}},[e._v("\r\n                立即登录\r\n              ")]),e._v(" "),r("div",{staticClass:"caerror"},[e._v(e._s(e.ca_error))])],1),e._v(" "),r("p",{staticClass:"login_ca_p"},[e._v("首次登录时，请下载并安装 “"),r("a",{staticStyle:{color:"#1686EA"},attrs:{href:"#"}},[e._v("CA证书客户端")]),e._v("” 仅支持IE浏览器")])])],1),e._v(" "),r("div",{staticClass:"ysAccountBtn",on:{click:e.ysLogin}},[e._v("演示账号")])],1)])])},staticRenderFns:[]};var d=s("vSla")(l,u,!1,function(e){s("3AqX"),s("D7g7"),s("s3CR")},"data-v-8e662a76",null);t.default=d.exports},s3CR:function(e,t){}});
//# sourceMappingURL=5.5cd47f81aab459280ac8.js.map